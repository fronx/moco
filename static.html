<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="http://codemirror.net/lib/codemirror.css" />
  <link rel="stylesheet" type="text/css" href="css/style.css" />
  <script src="https://raw.github.com/fronx/moco/master/moco.js"></script>
  <script src="https://raw.github.com/marijnh/CodeMirror/master/lib/codemirror.js"></script>
  <script src="https://raw.github.com/marijnh/CodeMirror/master/addon/fold/foldcode.js"></script>
</head>
<body>
<script>
window.onload = function() {
  // url = 'https://github.com/marijnh/acorn/blob/master/acorn_loose.js';
  code = "Moco = {};\n\n\x2F\x2F http:\x2F\x2Fstackoverflow.com\x2Fquestions\x2F2820249\x2Fbase64-encoding-and-decoding-in-client-side-javascript\nMoco.decodeBase64 = function (s) {\n  var e={},i,k,v=[],r=\'\',w=String.fromCharCode;\n  var n=[[65,91],[97,123],[48,58],[43,44],[47,48]];\n\n  for(z in n){for(i=n[z][0];i\x3Cn[z][1];i++){v.push(w(i));}}\n  for(i=0;i\x3C64;i++){e[v[i]]=i;}\n\n  for(i=0;i\x3Cs.length;i+=72){\n    var b=0,c,x,l=0,o=s.substring(i,i+72);\n    for(x=0;x\x3Co.length;x++){\n      c=e[o.charAt(x)];b=(b\x3C\x3C6)+c;l+=6;\n        while(l\x3E=8){r+=w((b\x3E\x3E\x3E(l-=8))%256);}\n    }\n  }\n  return r;\n}\n\n\x2F\x2F http:\x2F\x2Fstackoverflow.com\x2Fquestions\x2F8618464\x2Fhow-to-wait-for-another-js-to-load-to-proceed-operation\nMoco.whenAvailable = function (parent, name, callback) {\n  var interval = 10; \x2F\x2F ms\n  window.setTimeout(function() {\n    if (parent[name]) {\n      callback(parent[name]);\n    } else {\n      window.setTimeout(arguments.callee, interval);\n    }\n  }, interval);\n}\n\nMoco.get = function (url, fn) {\n  var request = new XMLHttpRequest();\n  request.open(\'GET\', url, true);\n  request.onload = function () {\n    fn(this.responseText);\n  };\n  request.send(null);\n}\n\nMoco.loadScript = function (url) {\n  document.body\n    .appendChild(document.createElement(\'script\'))\n    .src = url;\n}\n\n Moco.loadStyles = function (url) {\n  elem = document.createElement(\'link\');\n  elem.rel = \'stylesheet\';\n  elem.type = \'text\x2Fcss\';\n  elem.href = url;\n  document.body.appendChild(elem);\n}\n\nMoco.unpackContentAsCode = function (response) {\n  var doc = JSON.parse(response);\n  var lines64 = doc[\'content\'].split(\"\\n\")\n  var lines = decodeBase64(lines64.join(\'\'));\n  lines = lines.split(\"\\n\");\n  lines.pop();\n  var code = lines.join(\"\\n\");\n  return code;\n}\n\nMoco.createTextArea = function () {\n  var elem = document.createElement(\'textarea\');\n  document.body.appendChild(elem);\n  return elem;\n}\n\nMoco.initEditor = function (textarea, code) {\n  textarea.value = code;\n  whenAvailable(window, \'CodeMirror\', function () {\n    whenAvailable(CodeMirror, \'newFoldFunction\', function () {\n      var foldFunc = CodeMirror.newFoldFunction(CodeMirror.braceRangeFinder);\n      window.editor = CodeMirror.fromTextArea(textarea, {\n        mode: \"javascript\",\n        lineNumbers: true,\n        lineWrapping: true\n      });\n      editor.on(\"gutterClick\", foldFunc);\n      foldFunc(editor, 2); \x2F\x2F todo: do this for all function declarations\n      \x2F\x2F pre \x3E span.cm-keyword[text=\"function\"]\n    });\n  });\n}\n\nMoco.githubApiUrl = function (url) {\n  return url.replace(\'\x2F\x2Fgithub.com\', \'\x2F\x2Fapi.github.com\x2Frepos\').replace(\'\x2Fblob\x2Fmaster\x2F\', \'\x2Fcontents\x2F\');\n}\n\nMoco.editor = function (url) {\n  Moco.get(Moco.githubApiUrl(url), function (response) {\n    Moco.initEditor(\n      Moco.createTextArea(),\n      Moco.unpackContentAsCode(response)\n    );\n  });\n}\n\nMoco.replacePage = function () {\n  \x2F\x2F gather info\n  var codeFileUrl = window.location.href;\n\n  \x2F\x2F remove all the content!!!\n  while (document.body.firstChild) { document.body.removeChild(document.body.firstChild) };\n  while (document.head.firstChild) { document.head.removeChild(document.head.firstChild) };\n\n  \x2F\x2F the post-content world\n  Moco.loadStyles(\'https:\x2F\x2Fraw.github.com\x2Fmarijnh\x2FCodeMirror\x2Fmaster\x2Flib\x2Fcodemirror.css\');\n  Moco.loadScript(\'https:\x2F\x2Fraw.github.com\x2Fmarijnh\x2FCodeMirror\x2Fmaster\x2Flib\x2Fcodemirror.js\');\n  Moco.loadScript(\'https:\x2F\x2Fraw.github.com\x2Fmarijnh\x2FCodeMirror\x2Fmaster\x2Faddon\x2Ffold\x2Ffoldcode.js\');\n\n  Moco.editorFromUrl(codeFileUrl);\n}\n";
  Moco.initEditor(
    Moco.createTextArea(),
    code,
    "javascript"
  );
}
</script>
</body>
</html>